2024-11-20 12:04:58 [INFO]   batch_size: 16, epoch: 16
2024-11-20 12:04:58 [INFO]   知识对比学习损失的权重: 0.6
2024-11-20 12:04:58 [INFO]   学习率:
2024-11-20 12:04:58 [INFO]       mbert 编码器: 1e-5
2024-11-20 12:04:58 [INFO]       query_knowledge_fusion: 1e-3
2024-11-20 12:04:58 [INFO]       GCN: 1e-3
2024-11-20 12:04:58 [INFO]       classifier: 1e-3
2024-11-20 12:04:58 [INFO]   v_kg: mean pooling
2024-11-20 12:04:58 [INFO]   相邻实体数量 6
2024-11-20 12:04:58 [INFO]   ***** Running training *****
2024-11-20 12:04:58 [INFO]   当前时间: 2024-11-20 12:04:58
2024-11-20 12:04:58 [INFO]   Num examples = 5087
2024-11-20 12:04:58 [INFO]   Num Epochs = 16
2024-11-20 12:04:58 [INFO]   Instantaneous batch size per device = 8
2024-11-20 12:04:58 [INFO]   Total train batch size (w. parallel, distributed & accumulation) = 16
2024-11-20 12:04:58 [INFO]   Total optimization steps = 10160
2024-11-20 12:04:58 [INFO]   训练的设备: cuda, 设备编号: 0
2024-11-20 12:05:29 [INFO]   loss: 2.6191,	steps: 50/10160,	epoch: 0,	learning_rate: 7.874015748031496e-07
2024-11-20 12:06:00 [INFO]   loss: 1.4927,	steps: 100/10160,	epoch: 0,	learning_rate: 1.5748031496062992e-06
2024-11-20 12:06:32 [INFO]   loss: 1.0271,	steps: 150/10160,	epoch: 0,	learning_rate: 2.362204724409449e-06
2024-11-20 12:07:04 [INFO]   loss: 0.6956,	steps: 200/10160,	epoch: 0,	learning_rate: 3.1496062992125985e-06
2024-11-20 12:07:35 [INFO]   loss: 0.5854,	steps: 250/10160,	epoch: 0,	learning_rate: 3.937007874015748e-06
2024-11-20 12:08:06 [INFO]   loss: 0.7759,	steps: 300/10160,	epoch: 0,	learning_rate: 4.724409448818898e-06
2024-11-20 12:08:38 [INFO]   loss: 0.3099,	steps: 350/10160,	epoch: 0,	learning_rate: 5.511811023622048e-06
2024-11-20 12:09:09 [INFO]   loss: 0.5178,	steps: 400/10160,	epoch: 0,	learning_rate: 6.299212598425197e-06
2024-11-20 12:09:41 [INFO]   loss: 0.2918,	steps: 450/10160,	epoch: 0,	learning_rate: 7.086614173228347e-06
2024-11-20 12:10:13 [INFO]   loss: 0.5223,	steps: 500/10160,	epoch: 0,	learning_rate: 7.874015748031496e-06
2024-11-20 12:10:44 [INFO]   loss: 0.3398,	steps: 550/10160,	epoch: 0,	learning_rate: 8.661417322834647e-06
2024-11-20 12:11:16 [INFO]   loss: 0.4577,	steps: 600/10160,	epoch: 0,	learning_rate: 9.448818897637797e-06
2024-11-20 12:45:54 [INFO]   第0轮的训练 测试结果为：{'R@5': 0.45898930511878266, 'R@10': 0.6273003703584813, 'RR@5': 0.7639859068627459, 'RR@10': 0.7703847163865556, 'nDCG@5': 0.5530588409503183, 'nDCG@10': 0.606199929076515}
2024-11-20 12:45:55 [INFO]   ------------------------------------------------
2024-11-20 12:45:55 [INFO]   第 0 轮已经训练完成  模型保存在 /mnt/workspace/clir/myself/output/2024-11-20/best_model
2024-11-20 12:45:55 [INFO]   ------------------------------------------------
2024-11-20 12:46:04 [INFO]   loss: 0.2856,	steps: 650/10160,	epoch: 1,	learning_rate: 9.984251968503938e-06
2024-11-20 12:46:35 [INFO]   loss: 0.2820,	steps: 700/10160,	epoch: 1,	learning_rate: 9.931758530183728e-06
2024-11-20 12:47:07 [INFO]   loss: 0.2765,	steps: 750/10160,	epoch: 1,	learning_rate: 9.879265091863518e-06
2024-11-20 12:47:39 [INFO]   loss: 0.3305,	steps: 800/10160,	epoch: 1,	learning_rate: 9.826771653543308e-06
2024-11-20 12:48:11 [INFO]   loss: 0.2735,	steps: 850/10160,	epoch: 1,	learning_rate: 9.774278215223098e-06
2024-11-20 12:48:43 [INFO]   loss: 0.2720,	steps: 900/10160,	epoch: 1,	learning_rate: 9.721784776902888e-06
2024-11-20 12:49:15 [INFO]   loss: 0.1185,	steps: 950/10160,	epoch: 1,	learning_rate: 9.669291338582679e-06
2024-11-20 12:49:47 [INFO]   loss: 0.4621,	steps: 1000/10160,	epoch: 1,	learning_rate: 9.616797900262467e-06
2024-11-20 12:50:18 [INFO]   loss: 0.3165,	steps: 1050/10160,	epoch: 1,	learning_rate: 9.564304461942257e-06
2024-11-20 12:50:50 [INFO]   loss: 0.4987,	steps: 1100/10160,	epoch: 1,	learning_rate: 9.511811023622049e-06
2024-11-20 12:51:21 [INFO]   loss: 0.2102,	steps: 1150/10160,	epoch: 1,	learning_rate: 9.459317585301838e-06
2024-11-20 12:51:53 [INFO]   loss: 0.3281,	steps: 1200/10160,	epoch: 1,	learning_rate: 9.406824146981628e-06
2024-11-20 12:52:25 [INFO]   loss: 0.2512,	steps: 1250/10160,	epoch: 1,	learning_rate: 9.354330708661418e-06
2024-11-20 13:26:48 [INFO]   第1轮的训练 测试结果为：{'R@5': 0.48539866619607525, 'R@10': 0.6654617741884784, 'RR@5': 0.8000000000000008, 'RR@10': 0.8072588410364151, 'nDCG@5': 0.5901417375680131, 'nDCG@10': 0.6463766296501349}
2024-11-20 13:26:51 [INFO]   ------------------------------------------------
2024-11-20 13:26:51 [INFO]   第 1 轮已经训练完成  模型保存在 /mnt/workspace/clir/myself/output/2024-11-20/best_model
2024-11-20 13:26:51 [INFO]   ------------------------------------------------
2024-11-20 13:27:10 [INFO]   loss: 0.2049,	steps: 1300/10160,	epoch: 2,	learning_rate: 9.301837270341208e-06
2024-11-20 13:27:42 [INFO]   loss: 0.3040,	steps: 1350/10160,	epoch: 2,	learning_rate: 9.249343832020998e-06
2024-11-20 13:28:14 [INFO]   loss: 0.3246,	steps: 1400/10160,	epoch: 2,	learning_rate: 9.196850393700788e-06
2024-11-20 13:28:45 [INFO]   loss: 0.2808,	steps: 1450/10160,	epoch: 2,	learning_rate: 9.144356955380579e-06
2024-11-20 13:29:18 [INFO]   loss: 0.3703,	steps: 1500/10160,	epoch: 2,	learning_rate: 9.091863517060369e-06
2024-11-20 13:29:49 [INFO]   loss: 0.1674,	steps: 1550/10160,	epoch: 2,	learning_rate: 9.039370078740159e-06
2024-11-20 13:30:21 [INFO]   loss: 0.1813,	steps: 1600/10160,	epoch: 2,	learning_rate: 8.986876640419947e-06
2024-11-20 13:30:52 [INFO]   loss: 0.1537,	steps: 1650/10160,	epoch: 2,	learning_rate: 8.934383202099738e-06
2024-11-20 13:31:23 [INFO]   loss: 0.6329,	steps: 1700/10160,	epoch: 2,	learning_rate: 8.88188976377953e-06
2024-11-20 13:31:56 [INFO]   loss: 0.3097,	steps: 1750/10160,	epoch: 2,	learning_rate: 8.829396325459318e-06
2024-11-20 13:32:27 [INFO]   loss: 0.4832,	steps: 1800/10160,	epoch: 2,	learning_rate: 8.776902887139108e-06
2024-11-20 13:32:58 [INFO]   loss: 0.2163,	steps: 1850/10160,	epoch: 2,	learning_rate: 8.724409448818898e-06
2024-11-20 13:33:30 [INFO]   loss: 0.1706,	steps: 1900/10160,	epoch: 2,	learning_rate: 8.671916010498688e-06
2024-11-20 14:07:44 [INFO]   第2轮的训练 测试结果为：{'R@5': 0.4908410318946936, 'R@10': 0.655887069490182, 'RR@5': 0.809819240196079, 'RR@10': 0.8146639384920639, 'nDCG@5': 0.596209977460483, 'nDCG@10': 0.6460033968890293}
2024-11-20 14:08:12 [INFO]   loss: 0.3120,	steps: 1950/10160,	epoch: 3,	learning_rate: 8.619422572178478e-06
2024-11-20 14:08:44 [INFO]   loss: 0.2160,	steps: 2000/10160,	epoch: 3,	learning_rate: 8.566929133858269e-06
2024-11-20 14:09:15 [INFO]   loss: 0.2589,	steps: 2050/10160,	epoch: 3,	learning_rate: 8.514435695538059e-06
2024-11-20 14:09:46 [INFO]   loss: 0.2275,	steps: 2100/10160,	epoch: 3,	learning_rate: 8.461942257217849e-06
2024-11-20 14:10:17 [INFO]   loss: 0.2084,	steps: 2150/10160,	epoch: 3,	learning_rate: 8.409448818897639e-06
2024-11-20 14:10:48 [INFO]   loss: 0.1225,	steps: 2200/10160,	epoch: 3,	learning_rate: 8.356955380577428e-06
2024-11-20 14:11:20 [INFO]   loss: 0.2764,	steps: 2250/10160,	epoch: 3,	learning_rate: 8.304461942257218e-06
2024-11-20 14:11:52 [INFO]   loss: 0.2311,	steps: 2300/10160,	epoch: 3,	learning_rate: 8.25196850393701e-06
2024-11-20 14:12:23 [INFO]   loss: 0.1927,	steps: 2350/10160,	epoch: 3,	learning_rate: 8.199475065616798e-06
2024-11-20 14:12:54 [INFO]   loss: 0.2538,	steps: 2400/10160,	epoch: 3,	learning_rate: 8.146981627296588e-06
2024-11-20 14:13:26 [INFO]   loss: 0.3014,	steps: 2450/10160,	epoch: 3,	learning_rate: 8.094488188976378e-06
2024-11-20 14:13:59 [INFO]   loss: 0.4314,	steps: 2500/10160,	epoch: 3,	learning_rate: 8.041994750656169e-06
2024-11-20 14:48:41 [INFO]   第3轮的训练 测试结果为：{'R@5': 0.509153807832186, 'R@10': 0.676460604222441, 'RR@5': 0.8119332107843147, 'RR@10': 0.8164511116946788, 'nDCG@5': 0.6023707698673757, 'nDCG@10': 0.6559443322227497}
2024-11-20 14:48:44 [INFO]   ------------------------------------------------
2024-11-20 14:48:44 [INFO]   第 3 轮已经训练完成  模型保存在 /mnt/workspace/clir/myself/output/2024-11-20/best_model
2024-11-20 14:48:44 [INFO]   ------------------------------------------------
2024-11-20 14:48:50 [INFO]   loss: 0.0758,	steps: 2550/10160,	epoch: 4,	learning_rate: 7.989501312335959e-06
2024-11-20 14:49:22 [INFO]   loss: 0.1659,	steps: 2600/10160,	epoch: 4,	learning_rate: 7.937007874015749e-06
2024-11-20 14:49:53 [INFO]   loss: 0.3693,	steps: 2650/10160,	epoch: 4,	learning_rate: 7.884514435695539e-06
2024-11-20 14:50:24 [INFO]   loss: 0.3616,	steps: 2700/10160,	epoch: 4,	learning_rate: 7.83202099737533e-06
2024-11-20 14:50:55 [INFO]   loss: 0.1654,	steps: 2750/10160,	epoch: 4,	learning_rate: 7.77952755905512e-06
2024-11-20 14:51:28 [INFO]   loss: 0.1438,	steps: 2800/10160,	epoch: 4,	learning_rate: 7.72703412073491e-06
2024-11-20 14:52:00 [INFO]   loss: 0.3124,	steps: 2850/10160,	epoch: 4,	learning_rate: 7.674540682414698e-06
2024-11-20 14:52:33 [INFO]   loss: 0.1451,	steps: 2900/10160,	epoch: 4,	learning_rate: 7.622047244094489e-06
2024-11-20 14:53:04 [INFO]   loss: 0.2023,	steps: 2950/10160,	epoch: 4,	learning_rate: 7.569553805774279e-06
2024-11-20 14:53:35 [INFO]   loss: 0.3078,	steps: 3000/10160,	epoch: 4,	learning_rate: 7.5170603674540684e-06
2024-11-20 14:54:07 [INFO]   loss: 0.2049,	steps: 3050/10160,	epoch: 4,	learning_rate: 7.464566929133859e-06
2024-11-20 14:54:39 [INFO]   loss: 0.1162,	steps: 3100/10160,	epoch: 4,	learning_rate: 7.41207349081365e-06
2024-11-20 14:55:10 [INFO]   loss: 0.2661,	steps: 3150/10160,	epoch: 4,	learning_rate: 7.359580052493439e-06
2024-11-20 15:29:40 [INFO]   第4轮的训练 测试结果为：{'R@5': 0.5132415810379899, 'R@10': 0.6800788314339784, 'RR@5': 0.8300245098039225, 'RR@10': 0.8344639939309063, 'nDCG@5': 0.6244080431572786, 'nDCG@10': 0.6715507929965794}
2024-11-20 15:29:43 [INFO]   ------------------------------------------------
2024-11-20 15:29:43 [INFO]   第 4 轮已经训练完成  模型保存在 /mnt/workspace/clir/myself/output/2024-11-20/best_model
2024-11-20 15:29:43 [INFO]   ------------------------------------------------
2024-11-20 15:29:58 [INFO]   loss: 0.2530,	steps: 3200/10160,	epoch: 5,	learning_rate: 7.307086614173229e-06
2024-11-20 15:30:29 [INFO]   loss: 0.1677,	steps: 3250/10160,	epoch: 5,	learning_rate: 7.254593175853018e-06
2024-11-20 15:31:01 [INFO]   loss: 0.1220,	steps: 3300/10160,	epoch: 5,	learning_rate: 7.202099737532809e-06
2024-11-20 15:31:32 [INFO]   loss: 0.3022,	steps: 3350/10160,	epoch: 5,	learning_rate: 7.1496062992125995e-06
2024-11-20 15:32:04 [INFO]   loss: 0.2889,	steps: 3400/10160,	epoch: 5,	learning_rate: 7.097112860892389e-06
2024-11-20 15:32:35 [INFO]   loss: 0.2748,	steps: 3450/10160,	epoch: 5,	learning_rate: 7.044619422572179e-06
2024-11-20 15:33:07 [INFO]   loss: 0.1370,	steps: 3500/10160,	epoch: 5,	learning_rate: 6.992125984251969e-06
2024-11-20 15:33:39 [INFO]   loss: 0.0973,	steps: 3550/10160,	epoch: 5,	learning_rate: 6.939632545931759e-06
2024-11-20 15:34:10 [INFO]   loss: 0.1464,	steps: 3600/10160,	epoch: 5,	learning_rate: 6.887139107611549e-06
2024-11-20 15:34:42 [INFO]   loss: 0.2331,	steps: 3650/10160,	epoch: 5,	learning_rate: 6.834645669291339e-06
2024-11-20 15:35:14 [INFO]   loss: 0.1503,	steps: 3700/10160,	epoch: 5,	learning_rate: 6.78215223097113e-06
2024-11-20 15:35:45 [INFO]   loss: 0.1249,	steps: 3750/10160,	epoch: 5,	learning_rate: 6.729658792650919e-06
2024-11-20 15:36:18 [INFO]   loss: 0.1140,	steps: 3800/10160,	epoch: 5,	learning_rate: 6.677165354330709e-06
2024-11-20 16:10:38 [INFO]   第5轮的训练 测试结果为：{'R@5': 0.5117269568036231, 'R@10': 0.6852722126608249, 'RR@5': 0.8353707107843141, 'RR@10': 0.8404050682773113, 'nDCG@5': 0.6321451941106957, 'nDCG@10': 0.6808640491569715}
2024-11-20 16:10:40 [INFO]   ------------------------------------------------
2024-11-20 16:10:40 [INFO]   第 5 轮已经训练完成  模型保存在 /mnt/workspace/clir/myself/output/2024-11-20/best_model
2024-11-20 16:10:40 [INFO]   ------------------------------------------------
2024-11-20 16:11:06 [INFO]   loss: 0.1987,	steps: 3850/10160,	epoch: 6,	learning_rate: 6.624671916010499e-06
2024-11-20 16:11:37 [INFO]   loss: 0.1956,	steps: 3900/10160,	epoch: 6,	learning_rate: 6.57217847769029e-06
2024-11-20 16:12:08 [INFO]   loss: 0.1594,	steps: 3950/10160,	epoch: 6,	learning_rate: 6.51968503937008e-06
2024-11-20 16:12:39 [INFO]   loss: 0.1715,	steps: 4000/10160,	epoch: 6,	learning_rate: 6.467191601049869e-06
2024-11-20 16:13:11 [INFO]   loss: 0.2428,	steps: 4050/10160,	epoch: 6,	learning_rate: 6.414698162729659e-06
2024-11-20 16:13:42 [INFO]   loss: 0.4057,	steps: 4100/10160,	epoch: 6,	learning_rate: 6.362204724409449e-06
2024-11-20 16:14:13 [INFO]   loss: 0.0646,	steps: 4150/10160,	epoch: 6,	learning_rate: 6.3097112860892396e-06
2024-11-20 16:14:46 [INFO]   loss: 0.1891,	steps: 4200/10160,	epoch: 6,	learning_rate: 6.257217847769029e-06
2024-11-20 16:15:17 [INFO]   loss: 0.4308,	steps: 4250/10160,	epoch: 6,	learning_rate: 6.204724409448819e-06
2024-11-20 16:15:49 [INFO]   loss: 0.3343,	steps: 4300/10160,	epoch: 6,	learning_rate: 6.15223097112861e-06
2024-11-20 16:16:21 [INFO]   loss: 0.0771,	steps: 4350/10160,	epoch: 6,	learning_rate: 6.099737532808399e-06
2024-11-20 16:16:53 [INFO]   loss: 0.2375,	steps: 4400/10160,	epoch: 6,	learning_rate: 6.0472440944881895e-06
2024-11-20 16:51:37 [INFO]   第6轮的训练 测试结果为：{'R@5': 0.5272072663053142, 'R@10': 0.6924780081475558, 'RR@5': 0.844224877450981, 'RR@10': 0.8488365137721757, 'nDCG@5': 0.637427559546661, 'nDCG@10': 0.6865947045357226}
2024-11-20 16:51:40 [INFO]   ------------------------------------------------
2024-11-20 16:51:40 [INFO]   第 6 轮已经训练完成  模型保存在 /mnt/workspace/clir/myself/output/2024-11-20/best_model
2024-11-20 16:51:40 [INFO]   ------------------------------------------------
2024-11-20 16:51:43 [INFO]   loss: 0.2847,	steps: 4450/10160,	epoch: 7,	learning_rate: 5.994750656167979e-06
2024-11-20 16:52:15 [INFO]   loss: 0.0581,	steps: 4500/10160,	epoch: 7,	learning_rate: 5.94225721784777e-06
2024-11-20 16:52:46 [INFO]   loss: 0.1624,	steps: 4550/10160,	epoch: 7,	learning_rate: 5.88976377952756e-06
2024-11-20 16:53:17 [INFO]   loss: 0.1700,	steps: 4600/10160,	epoch: 7,	learning_rate: 5.837270341207349e-06
2024-11-20 16:53:49 [INFO]   loss: 0.0697,	steps: 4650/10160,	epoch: 7,	learning_rate: 5.7847769028871395e-06
2024-11-20 16:54:20 [INFO]   loss: 0.1172,	steps: 4700/10160,	epoch: 7,	learning_rate: 5.7322834645669305e-06
2024-11-20 16:54:51 [INFO]   loss: 0.3311,	steps: 4750/10160,	epoch: 7,	learning_rate: 5.67979002624672e-06
2024-11-20 16:55:22 [INFO]   loss: 0.2664,	steps: 4800/10160,	epoch: 7,	learning_rate: 5.62729658792651e-06
2024-11-20 16:55:53 [INFO]   loss: 0.3951,	steps: 4850/10160,	epoch: 7,	learning_rate: 5.574803149606299e-06
2024-11-20 16:56:25 [INFO]   loss: 0.0805,	steps: 4900/10160,	epoch: 7,	learning_rate: 5.52230971128609e-06
2024-11-20 16:56:57 [INFO]   loss: 0.0910,	steps: 4950/10160,	epoch: 7,	learning_rate: 5.46981627296588e-06
2024-11-20 16:57:29 [INFO]   loss: 0.2582,	steps: 5000/10160,	epoch: 7,	learning_rate: 5.41732283464567e-06
2024-11-20 16:58:01 [INFO]   loss: 0.1894,	steps: 5050/10160,	epoch: 7,	learning_rate: 5.364829396325459e-06
2024-11-20 17:32:32 [INFO]   第7轮的训练 测试结果为：{'R@5': 0.5289821035238779, 'R@10': 0.6914857000883621, 'RR@5': 0.848085171568628, 'RR@10': 0.8521249124649862, 'nDCG@5': 0.6507174890289926, 'nDCG@10': 0.695820544124758}
2024-11-20 17:32:35 [INFO]   ------------------------------------------------
2024-11-20 17:32:35 [INFO]   第 7 轮已经训练完成  模型保存在 /mnt/workspace/clir/myself/output/2024-11-20/best_model
2024-11-20 17:32:35 [INFO]   ------------------------------------------------
2024-11-20 17:32:48 [INFO]   loss: 0.1421,	steps: 5100/10160,	epoch: 8,	learning_rate: 5.31233595800525e-06
2024-11-20 17:33:20 [INFO]   loss: 0.2178,	steps: 5150/10160,	epoch: 8,	learning_rate: 5.25984251968504e-06
2024-11-20 17:33:51 [INFO]   loss: 0.0860,	steps: 5200/10160,	epoch: 8,	learning_rate: 5.2073490813648295e-06
2024-11-20 17:34:22 [INFO]   loss: 0.2353,	steps: 5250/10160,	epoch: 8,	learning_rate: 5.15485564304462e-06
2024-11-20 17:34:53 [INFO]   loss: 0.1468,	steps: 5300/10160,	epoch: 8,	learning_rate: 5.102362204724411e-06
2024-11-20 17:35:25 [INFO]   loss: 0.1426,	steps: 5350/10160,	epoch: 8,	learning_rate: 5.0498687664042e-06
2024-11-20 17:35:57 [INFO]   loss: 0.2201,	steps: 5400/10160,	epoch: 8,	learning_rate: 4.99737532808399e-06
2024-11-20 17:36:27 [INFO]   loss: 0.1922,	steps: 5450/10160,	epoch: 8,	learning_rate: 4.94488188976378e-06
2024-11-20 17:37:00 [INFO]   loss: 0.1606,	steps: 5500/10160,	epoch: 8,	learning_rate: 4.89238845144357e-06
2024-11-20 17:37:32 [INFO]   loss: 0.0678,	steps: 5550/10160,	epoch: 8,	learning_rate: 4.83989501312336e-06
2024-11-20 17:38:02 [INFO]   loss: 0.3294,	steps: 5600/10160,	epoch: 8,	learning_rate: 4.78740157480315e-06
2024-11-20 17:38:33 [INFO]   loss: 0.1925,	steps: 5650/10160,	epoch: 8,	learning_rate: 4.73490813648294e-06
2024-11-20 17:39:05 [INFO]   loss: 0.1384,	steps: 5700/10160,	epoch: 8,	learning_rate: 4.68241469816273e-06
2024-11-20 18:13:26 [INFO]   第8轮的训练 测试结果为：{'R@5': 0.5201400654311609, 'R@10': 0.6890545280654522, 'RR@5': 0.832506127450981, 'RR@10': 0.8372797035480863, 'nDCG@5': 0.6317411394955913, 'nDCG@10': 0.6806481103806641}
2024-11-20 18:13:49 [INFO]   loss: 0.1297,	steps: 5750/10160,	epoch: 9,	learning_rate: 4.6299212598425204e-06
2024-11-20 18:14:21 [INFO]   loss: 0.1102,	steps: 5800/10160,	epoch: 9,	learning_rate: 4.57742782152231e-06
2024-11-20 18:14:53 [INFO]   loss: 0.1094,	steps: 5850/10160,	epoch: 9,	learning_rate: 4.5249343832021e-06
2024-11-20 18:15:25 [INFO]   loss: 0.1055,	steps: 5900/10160,	epoch: 9,	learning_rate: 4.47244094488189e-06
2024-11-20 18:15:56 [INFO]   loss: 0.3057,	steps: 5950/10160,	epoch: 9,	learning_rate: 4.41994750656168e-06
2024-11-20 18:16:27 [INFO]   loss: 0.2460,	steps: 6000/10160,	epoch: 9,	learning_rate: 4.36745406824147e-06
2024-11-20 18:17:00 [INFO]   loss: 0.1720,	steps: 6050/10160,	epoch: 9,	learning_rate: 4.3149606299212606e-06
2024-11-20 18:17:31 [INFO]   loss: 0.0323,	steps: 6100/10160,	epoch: 9,	learning_rate: 4.26246719160105e-06
2024-11-20 18:18:02 [INFO]   loss: 0.1720,	steps: 6150/10160,	epoch: 9,	learning_rate: 4.209973753280841e-06
2024-11-20 18:18:34 [INFO]   loss: 0.1681,	steps: 6200/10160,	epoch: 9,	learning_rate: 4.15748031496063e-06
2024-11-20 18:19:05 [INFO]   loss: 0.2298,	steps: 6250/10160,	epoch: 9,	learning_rate: 4.10498687664042e-06
2024-11-20 18:19:36 [INFO]   loss: 0.0862,	steps: 6300/10160,	epoch: 9,	learning_rate: 4.0524934383202105e-06
2024-11-20 18:20:06 [INFO]   loss: 0.0865,	steps: 6350/10160,	epoch: 9,	learning_rate: 4.000000000000001e-06
2024-11-20 18:54:21 [INFO]   第9轮的训练 测试结果为：{'R@5': 0.5285927865217823, 'R@10': 0.6910181996394147, 'RR@5': 0.8249080882352946, 'RR@10': 0.8294124941643327, 'nDCG@5': 0.6299762081106022, 'nDCG@10': 0.6778952566846467}
2024-11-20 18:54:52 [INFO]   loss: 0.2818,	steps: 6400/10160,	epoch: 10,	learning_rate: 3.94750656167979e-06
2024-11-20 18:55:24 [INFO]   loss: 0.0593,	steps: 6450/10160,	epoch: 10,	learning_rate: 3.895013123359581e-06
2024-11-20 18:55:55 [INFO]   loss: 0.3189,	steps: 6500/10160,	epoch: 10,	learning_rate: 3.84251968503937e-06
2024-11-20 18:56:26 [INFO]   loss: 0.1591,	steps: 6550/10160,	epoch: 10,	learning_rate: 3.7900262467191605e-06
2024-11-20 18:56:57 [INFO]   loss: 0.0525,	steps: 6600/10160,	epoch: 10,	learning_rate: 3.73753280839895e-06
2024-11-20 18:57:29 [INFO]   loss: 0.0823,	steps: 6650/10160,	epoch: 10,	learning_rate: 3.6850393700787408e-06
2024-11-20 18:58:02 [INFO]   loss: 0.1111,	steps: 6700/10160,	epoch: 10,	learning_rate: 3.6325459317585305e-06
2024-11-20 18:58:33 [INFO]   loss: 0.2107,	steps: 6750/10160,	epoch: 10,	learning_rate: 3.5800524934383207e-06
2024-11-20 18:59:04 [INFO]   loss: 0.1816,	steps: 6800/10160,	epoch: 10,	learning_rate: 3.5275590551181104e-06
2024-11-20 18:59:35 [INFO]   loss: 0.0668,	steps: 6850/10160,	epoch: 10,	learning_rate: 3.4750656167979006e-06
2024-11-20 19:00:08 [INFO]   loss: 0.2924,	steps: 6900/10160,	epoch: 10,	learning_rate: 3.4225721784776907e-06
2024-11-20 19:00:39 [INFO]   loss: 0.1163,	steps: 6950/10160,	epoch: 10,	learning_rate: 3.370078740157481e-06
2024-11-20 19:35:11 [INFO]   第10轮的训练 测试结果为：{'R@5': 0.5323445698637423, 'R@10': 0.6946987259916626, 'RR@5': 0.8494944852941182, 'RR@10': 0.8531505310457519, 'nDCG@5': 0.6513026945777878, 'nDCG@10': 0.6960016143017399}
2024-11-20 19:35:14 [INFO]   ------------------------------------------------
2024-11-20 19:35:14 [INFO]   第 10 轮已经训练完成  模型保存在 /mnt/workspace/clir/myself/output/2024-11-20/best_model
2024-11-20 19:35:14 [INFO]   ------------------------------------------------
2024-11-20 19:35:24 [INFO]   loss: 0.0527,	steps: 7000/10160,	epoch: 11,	learning_rate: 3.3175853018372706e-06
2024-11-20 19:35:56 [INFO]   loss: 0.2358,	steps: 7050/10160,	epoch: 11,	learning_rate: 3.2650918635170608e-06
2024-11-20 19:36:27 [INFO]   loss: 0.1071,	steps: 7100/10160,	epoch: 11,	learning_rate: 3.2125984251968505e-06
2024-11-20 19:36:59 [INFO]   loss: 0.2165,	steps: 7150/10160,	epoch: 11,	learning_rate: 3.160104986876641e-06
2024-11-20 19:37:30 [INFO]   loss: 0.2787,	steps: 7200/10160,	epoch: 11,	learning_rate: 3.107611548556431e-06
2024-11-20 19:38:02 [INFO]   loss: 0.1011,	steps: 7250/10160,	epoch: 11,	learning_rate: 3.055118110236221e-06
2024-11-20 19:38:33 [INFO]   loss: 0.0751,	steps: 7300/10160,	epoch: 11,	learning_rate: 3.0026246719160107e-06
2024-11-20 19:39:04 [INFO]   loss: 0.2328,	steps: 7350/10160,	epoch: 11,	learning_rate: 2.950131233595801e-06
2024-11-20 19:39:36 [INFO]   loss: 0.0180,	steps: 7400/10160,	epoch: 11,	learning_rate: 2.8976377952755906e-06
2024-11-20 19:40:08 [INFO]   loss: 0.2361,	steps: 7450/10160,	epoch: 11,	learning_rate: 2.8451443569553812e-06
2024-11-20 19:40:39 [INFO]   loss: 0.1409,	steps: 7500/10160,	epoch: 11,	learning_rate: 2.792650918635171e-06
2024-11-20 19:41:11 [INFO]   loss: 0.1344,	steps: 7550/10160,	epoch: 11,	learning_rate: 2.740157480314961e-06
2024-11-20 19:41:41 [INFO]   loss: 0.0838,	steps: 7600/10160,	epoch: 11,	learning_rate: 2.687664041994751e-06
2024-11-20 20:16:03 [INFO]   第11轮的训练 测试结果为：{'R@5': 0.5225352561905899, 'R@10': 0.6882096253200142, 'RR@5': 0.8458486519607848, 'RR@10': 0.8505168213118584, 'nDCG@5': 0.6453781466298075, 'nDCG@10': 0.6895672127912197}
2024-11-20 20:16:22 [INFO]   loss: 0.1846,	steps: 7650/10160,	epoch: 12,	learning_rate: 2.635170603674541e-06
2024-11-20 20:16:54 [INFO]   loss: 0.0319,	steps: 7700/10160,	epoch: 12,	learning_rate: 2.5826771653543307e-06
2024-11-20 20:17:25 [INFO]   loss: 0.1732,	steps: 7750/10160,	epoch: 12,	learning_rate: 2.5301837270341213e-06
2024-11-20 20:17:56 [INFO]   loss: 0.1814,	steps: 7800/10160,	epoch: 12,	learning_rate: 2.477690288713911e-06
2024-11-20 20:18:28 [INFO]   loss: 0.1624,	steps: 7850/10160,	epoch: 12,	learning_rate: 2.425196850393701e-06
2024-11-20 20:19:00 [INFO]   loss: 0.1043,	steps: 7900/10160,	epoch: 12,	learning_rate: 2.372703412073491e-06
2024-11-20 20:19:31 [INFO]   loss: 0.1480,	steps: 7950/10160,	epoch: 12,	learning_rate: 2.320209973753281e-06
2024-11-20 20:20:03 [INFO]   loss: 0.1352,	steps: 8000/10160,	epoch: 12,	learning_rate: 2.267716535433071e-06
2024-11-20 20:20:35 [INFO]   loss: 0.2539,	steps: 8050/10160,	epoch: 12,	learning_rate: 2.215223097112861e-06
2024-11-20 20:21:07 [INFO]   loss: 0.0757,	steps: 8100/10160,	epoch: 12,	learning_rate: 2.162729658792651e-06
2024-11-20 20:21:38 [INFO]   loss: 0.2868,	steps: 8150/10160,	epoch: 12,	learning_rate: 2.110236220472441e-06
2024-11-20 20:22:09 [INFO]   loss: 0.3719,	steps: 8200/10160,	epoch: 12,	learning_rate: 2.057742782152231e-06
2024-11-20 20:22:40 [INFO]   loss: 0.2277,	steps: 8250/10160,	epoch: 12,	learning_rate: 2.0052493438320212e-06
2024-11-20 20:56:56 [INFO]   第12轮的训练 测试结果为：{'R@5': 0.5406530118770484, 'R@10': 0.7061964208200964, 'RR@5': 0.8589154411764713, 'RR@10': 0.8626856471755374, 'nDCG@5': 0.6618623428950606, 'nDCG@10': 0.7069889190786888}
2024-11-20 20:56:59 [INFO]   ------------------------------------------------
2024-11-20 20:56:59 [INFO]   第 12 轮已经训练完成  模型保存在 /mnt/workspace/clir/myself/output/2024-11-20/best_model
2024-11-20 20:56:59 [INFO]   ------------------------------------------------
2024-11-20 20:57:28 [INFO]   loss: 0.1894,	steps: 8300/10160,	epoch: 13,	learning_rate: 1.952755905511811e-06
2024-11-20 20:58:00 [INFO]   loss: 0.1429,	steps: 8350/10160,	epoch: 13,	learning_rate: 1.9002624671916011e-06
2024-11-20 20:58:30 [INFO]   loss: 0.1501,	steps: 8400/10160,	epoch: 13,	learning_rate: 1.8477690288713913e-06
2024-11-20 20:59:02 [INFO]   loss: 0.1204,	steps: 8450/10160,	epoch: 13,	learning_rate: 1.7952755905511812e-06
2024-11-20 20:59:34 [INFO]   loss: 0.2429,	steps: 8500/10160,	epoch: 13,	learning_rate: 1.7427821522309712e-06
2024-11-20 21:00:06 [INFO]   loss: 0.1834,	steps: 8550/10160,	epoch: 13,	learning_rate: 1.6902887139107613e-06
2024-11-20 21:00:37 [INFO]   loss: 0.2117,	steps: 8600/10160,	epoch: 13,	learning_rate: 1.6377952755905513e-06
2024-11-20 21:01:09 [INFO]   loss: 0.0762,	steps: 8650/10160,	epoch: 13,	learning_rate: 1.5853018372703412e-06
2024-11-20 21:01:41 [INFO]   loss: 0.0235,	steps: 8700/10160,	epoch: 13,	learning_rate: 1.5328083989501314e-06
2024-11-20 21:02:12 [INFO]   loss: 0.0715,	steps: 8750/10160,	epoch: 13,	learning_rate: 1.4803149606299213e-06
2024-11-20 21:02:44 [INFO]   loss: 0.1286,	steps: 8800/10160,	epoch: 13,	learning_rate: 1.4278215223097113e-06
2024-11-20 21:03:16 [INFO]   loss: 0.2409,	steps: 8850/10160,	epoch: 13,	learning_rate: 1.3753280839895015e-06
2024-11-20 21:37:54 [INFO]   第13轮的训练 测试结果为：{'R@5': 0.5417722290640415, 'R@10': 0.7045611100504551, 'RR@5': 0.8537837009803929, 'RR@10': 0.8573474702380958, 'nDCG@5': 0.6613273863552624, 'nDCG@10': 0.703750797559581}
2024-11-20 21:38:00 [INFO]   loss: 0.1281,	steps: 8900/10160,	epoch: 14,	learning_rate: 1.3228346456692914e-06
2024-11-20 21:38:32 [INFO]   loss: 0.1189,	steps: 8950/10160,	epoch: 14,	learning_rate: 1.2703412073490814e-06
2024-11-20 21:39:04 [INFO]   loss: 0.0242,	steps: 9000/10160,	epoch: 14,	learning_rate: 1.2178477690288715e-06
2024-11-20 21:39:36 [INFO]   loss: 0.1586,	steps: 9050/10160,	epoch: 14,	learning_rate: 1.1653543307086615e-06
2024-11-20 21:40:08 [INFO]   loss: 0.1458,	steps: 9100/10160,	epoch: 14,	learning_rate: 1.1128608923884516e-06
2024-11-20 21:40:40 [INFO]   loss: 0.0943,	steps: 9150/10160,	epoch: 14,	learning_rate: 1.0603674540682416e-06
2024-11-20 21:41:10 [INFO]   loss: 0.1964,	steps: 9200/10160,	epoch: 14,	learning_rate: 1.0078740157480315e-06
2024-11-20 21:41:42 [INFO]   loss: 0.3175,	steps: 9250/10160,	epoch: 14,	learning_rate: 9.553805774278217e-07
2024-11-20 21:42:13 [INFO]   loss: 0.0113,	steps: 9300/10160,	epoch: 14,	learning_rate: 9.028871391076116e-07
2024-11-20 21:42:44 [INFO]   loss: 0.1624,	steps: 9350/10160,	epoch: 14,	learning_rate: 8.503937007874017e-07
2024-11-20 21:43:15 [INFO]   loss: 0.1213,	steps: 9400/10160,	epoch: 14,	learning_rate: 7.979002624671916e-07
2024-11-20 21:43:47 [INFO]   loss: 0.1550,	steps: 9450/10160,	epoch: 14,	learning_rate: 7.454068241469817e-07
2024-11-20 21:44:19 [INFO]   loss: 0.1188,	steps: 9500/10160,	epoch: 14,	learning_rate: 6.929133858267717e-07
2024-11-20 22:18:46 [INFO]   第14轮的训练 测试结果为：{'R@5': 0.5398877128018708, 'R@10': 0.7028830071120342, 'RR@5': 0.855912990196079, 'RR@10': 0.8602324784080303, 'nDCG@5': 0.6609970522307529, 'nDCG@10': 0.704068228333733}
2024-11-20 22:19:02 [INFO]   loss: 0.1541,	steps: 9550/10160,	epoch: 15,	learning_rate: 6.404199475065617e-07
2024-11-20 22:19:34 [INFO]   loss: 0.2850,	steps: 9600/10160,	epoch: 15,	learning_rate: 5.879265091863517e-07
2024-11-20 22:20:05 [INFO]   loss: 0.0596,	steps: 9650/10160,	epoch: 15,	learning_rate: 5.354330708661418e-07
2024-11-20 22:20:37 [INFO]   loss: 0.1997,	steps: 9700/10160,	epoch: 15,	learning_rate: 4.829396325459318e-07
2024-11-20 22:21:08 [INFO]   loss: 0.1261,	steps: 9750/10160,	epoch: 15,	learning_rate: 4.304461942257218e-07
2024-11-20 22:21:39 [INFO]   loss: 0.1744,	steps: 9800/10160,	epoch: 15,	learning_rate: 3.7795275590551184e-07
2024-11-20 22:22:10 [INFO]   loss: 0.0905,	steps: 9850/10160,	epoch: 15,	learning_rate: 3.2545931758530185e-07
2024-11-20 22:22:42 [INFO]   loss: 0.0998,	steps: 9900/10160,	epoch: 15,	learning_rate: 2.729658792650919e-07
2024-11-20 22:23:13 [INFO]   loss: 0.2413,	steps: 9950/10160,	epoch: 15,	learning_rate: 2.204724409448819e-07
2024-11-20 22:23:43 [INFO]   loss: 0.1261,	steps: 10000/10160,	epoch: 15,	learning_rate: 1.6797900262467193e-07
2024-11-20 22:24:14 [INFO]   loss: 0.1750,	steps: 10050/10160,	epoch: 15,	learning_rate: 1.1548556430446196e-07
2024-11-20 22:24:46 [INFO]   loss: 0.3393,	steps: 10100/10160,	epoch: 15,	learning_rate: 6.299212598425197e-08
2024-11-20 22:25:17 [INFO]   loss: 0.1298,	steps: 10150/10160,	epoch: 15,	learning_rate: 1.0498687664041996e-08
2024-11-20 22:59:35 [INFO]   第15轮的训练 测试结果为：{'R@5': 0.5429765035202643, 'R@10': 0.7056406346201618, 'RR@5': 0.8588235294117654, 'RR@10': 0.8623533788515412, 'nDCG@5': 0.6638345514821865, 'nDCG@10': 0.7072101726322494}
2024-11-20 22:59:38 [INFO]   ------------------------------------------------
2024-11-20 22:59:38 [INFO]   第 15 轮已经训练完成  模型保存在 /mnt/workspace/clir/myself/output/2024-11-20/best_model
2024-11-20 22:59:38 [INFO]   ------------------------------------------------
2024-11-20 22:59:38 [INFO]   ------------------------------------------------
2024-11-20 22:59:38 [INFO]   最佳评测指标为: {'R@5': 0.5429765035202643, 'R@10': 0.7056406346201618, 'RR@5': 0.8588235294117654, 'RR@10': 0.8623533788515412, 'nDCG@5': 0.6638345514821865, 'nDCG@10': 0.7072101726322494}
2024-11-20 22:59:38 [INFO]   ------------------------------------------------
2024-11-20 22:59:38 [INFO]   ------------------------------------------------
2024-11-20 22:59:38 [INFO]   所有epoch的平均评测指标为: {'R@5': 0.5184026783739402, 'R@10': 0.6847929263880996, 'RR@5': 0.8327272901348046, 'RR@10': 0.8373479762998953, 'nDCG@5': 0.6308061958416793, 'nDCG@10': 0.6784677931509365}
2024-11-20 22:59:38 [INFO]   ------------------------------------------------
2024-11-20 23:25:16 [INFO]   batch_size: 16, epoch: 16
2024-11-20 23:25:16 [INFO]   知识对比学习损失的权重: 0.6
2024-11-20 23:25:16 [INFO]   学习率:
2024-11-20 23:25:16 [INFO]       mbert 编码器: 1e-5
2024-11-20 23:25:16 [INFO]       query_knowledge_fusion: 1e-3
2024-11-20 23:25:16 [INFO]       GCN: 1e-3
2024-11-20 23:25:16 [INFO]       classifier: 1e-3
2024-11-20 23:25:16 [INFO]   v_kg: mean pooling
2024-11-20 23:25:16 [INFO]   相邻实体数量 7
2024-11-20 23:25:16 [INFO]   ***** Running training *****
2024-11-20 23:25:16 [INFO]   当前时间: 2024-11-20 23:25:16
2024-11-20 23:25:16 [INFO]   Num examples = 5087
2024-11-20 23:25:16 [INFO]   Num Epochs = 16
2024-11-20 23:25:16 [INFO]   Instantaneous batch size per device = 8
2024-11-20 23:25:16 [INFO]   Total train batch size (w. parallel, distributed & accumulation) = 16
2024-11-20 23:25:16 [INFO]   Total optimization steps = 10160
2024-11-20 23:25:16 [INFO]   训练的设备: cuda, 设备编号: 0
2024-11-20 23:25:49 [INFO]   loss: 2.6594,	steps: 50/10160,	epoch: 0,	learning_rate: 7.874015748031496e-07
2024-11-20 23:26:23 [INFO]   loss: 1.6323,	steps: 100/10160,	epoch: 0,	learning_rate: 1.5748031496062992e-06
2024-11-20 23:26:57 [INFO]   loss: 1.0263,	steps: 150/10160,	epoch: 0,	learning_rate: 2.362204724409449e-06
2024-11-20 23:27:31 [INFO]   loss: 0.7614,	steps: 200/10160,	epoch: 0,	learning_rate: 3.1496062992125985e-06
2024-11-20 23:28:06 [INFO]   loss: 0.6409,	steps: 250/10160,	epoch: 0,	learning_rate: 3.937007874015748e-06
2024-11-20 23:28:39 [INFO]   loss: 0.7909,	steps: 300/10160,	epoch: 0,	learning_rate: 4.724409448818898e-06
2024-11-20 23:29:14 [INFO]   loss: 0.5543,	steps: 350/10160,	epoch: 0,	learning_rate: 5.511811023622048e-06
2024-11-20 23:29:47 [INFO]   loss: 0.5793,	steps: 400/10160,	epoch: 0,	learning_rate: 6.299212598425197e-06
2024-11-20 23:30:21 [INFO]   loss: 0.4185,	steps: 450/10160,	epoch: 0,	learning_rate: 7.086614173228347e-06
